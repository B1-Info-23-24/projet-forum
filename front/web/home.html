<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Motorum</title>
    <link rel="stylesheet" href="/static/home.css" />
  </head>
  <body>
    <div class="container">
      <aside class="sidebar">
        <div class="logo">Motorum</div>
        <div class="sections">
          <div class="section active">Les plus récents</div>
          <div class="section">Populaire du jour</div>
          <div class="section">Abonnement</div>
        </div>
        <div class="tags">
          <h2>Tags populaires</h2>
          <div class="tag">#LeBoncoin</div>
          <div class="tag">#Budget 10K</div>
          <div class="tag">#Budget 5K</div>
          <div class="tag">#Supermot</div>
          <div class="tag">#MotoGP</div>
          <div class="tag">#BMW</div>
        </div>
        <div class="pinned-group">Pinned Group</div>
      </aside>
      <main class="content">
        <div class="top-bar">
          <input type="text" placeholder="Tapez ici pour chercher..." />
          <button class="profile-button" onclick="location.href='/login'">
            Connexion
          </button>
        </div>
        <div class="post-box">
          <textarea
            placeholder="Partageons ce qui se passe dans votre esprit..."
            disabled
          ></textarea>
        </div>
        <div class="posts" id="posts">
          <!-- Les posts seront chargés ici -->
        </div>
      </main>
      <aside class="sidebar-right">
        <h2>Leboncoin top annonce</h2>
        <div class="ad">
          Bonjour je vends ma moto, un Z800 abs de 2016 que j'ai bridé car je
          suis encore...
        </div>
        <div class="ad">
          Bonjour je vend mon duke 790 de 2018 en très bon état prête à rouler,
          révision faite cher...
        </div>
        <div class="ad">Je vends une Suzuki GSR 750 en excellent état...</div>
        <div class="ad">
          SPEED TRIPLE 1050 avec ABS Mise en circulation 05/2015
        </div>
        <div class="ad">
          Km 980 R avec le tech pack. Moto en parfait état, entretien 100% chez
          KTM. Révision récente.
        </div>
        <div class="ad">
          Je vend ma KTM 690 SM-C R, pour passer sur un roadster.
        </div>
      </aside>
    </div>
    <script>
      async function loadPosts() {
        try {
          const response = await fetch('/posts');
          const posts = await response.json();
          const postsContainer = document.getElementById('posts');

          postsContainer.innerHTML = '';

          posts.forEach(post => {
            const postElement = document.createElement('div');
            postElement.classList.add('post');
            postElement.innerHTML = `
              <div class="author">${post.user_name} • ${new Date(post.created_at).toLocaleDateString()}</div>
              <div class="text">${post.content}</div>
              <div class="tags">
                ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
              </div>
              <div class="stats">
                <span>${post.views} Vues</span>
                <span>${post.likes} J'aime</span>
                <span>${post.comments} commentaires</span>
              </div>
            `;
            postsContainer.appendChild(postElement);
          });
        } catch (error) {
          console.error('Error loading posts:', error);
        }
      }

      document.addEventListener('DOMContentLoaded', loadPosts);
    </script>
  </body>
</html>
